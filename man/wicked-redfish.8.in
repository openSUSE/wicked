.\" Automatically generated by Pandoc 3.1.11.1
.\"
.TH "wicked\-redfish" "8" "Apr 12, 2021" "Wicked User Manual" ""
.SH NAME
wicked redfish \- redfish network host interface configuration utilities
.SH SYNOPSIS
\f[CR]wicked redfish [options] <action>\f[R]
.SH DESCRIPTION
The Redfish Network Host Interface defined by the DMTF Redfish Host
Interface Specification enables the software running on a computer
system to access the Redfish Service, which can be used to manage that
computer system.
.PP
Machines supporting a Redfish Network Host Interface, provide an SMBIOS
(3.0) Management Controller Host Interface (Type 42) structure
containing a Device Description of the Network (Type 40h) Interface and
\[lq]Redfish over IP\[rq] Protocol (Type 04h) records with the
configuration to use for this network interface, visible in
e.g.\ `\f[CR]dmidecode \-t 42\f[R]' output.
.PP
The Redfish Network Host Interface needs to be enabled and/or configured
in the Management Controller (BMC, firmware, \&...)
\[en] please consult the machine vendor documentation for further
details.
With enabled Redfish Network Host Interface in the Management
Controller, the SMBIOS structure and the network interface (usb, pci)
are available/appear in the system
(e.g.\ `\f[CR]hwinfo \-\-netcard\f[R]' or `\f[CR]lsusb\f[R]',
`\f[CR]lspci\f[R]', `\f[CR]ip link show\f[R]').
.PP
The `\f[CR]wicked redfish\f[R]' command implements utility actions
decoding the SMBIOS structures to configure the Network Host Interface
with these settings, used by other parts of wicked.
.PP
The automatic setup of the Redfish Network Host Interface from SMBIOS
settings with wicked is (currently) disabled by default, use the:
.IP
.EX
   wicked redfish enable
.EE
.PP
command to enable it once.
.PP
When enabled, the `\f[CR]wicked ifup\f[R]',
`\f[CR]wicked ifreload\f[R]', `\f[CR]wicked show\-config\f[R]' and
related commands to setup/shutdown interfaces as well as the
`\f[CR]systemctl\f[R]' (\f[CR]start\f[R], \f[CR]stop\f[R],
\f[CR]reload\f[R]) actions to the `\f[CR]network.service\f[R]' (alias to
an enabled `\f[CR]wicked.service\f[R]') will consider the Redfish
Network Host Interfaces.
.SH OPTIONS
.TP
\f[CR]\-\-help\f[R], \f[CR]\-h\f[R]
show short options and actions description and exit
.SH ACTIONS
.TP
\f[CR]enable\f[R]
Enables the redfish network host interface setup.
.RS
.PP
Alias to the \f[CR]wicked firmware enable redfish\f[R] command, enabling
the redfish extension decoding SMBIOS as a
\f[CR]\[dq]firmware:redfish\[dq]\f[R] wicked interface configuration
requested during e.g.\ \f[CR]wicked ifup all\f[R] run.
.RE
.TP
\f[CR]disable\f[R]
Disables the redfish network host interface setup.
.RS
.PP
Alias to the \f[CR]wicked firmware disable redfish\f[R] command,
disabling the redfish extension decoding SMBIOS as a
\f[CR]\[dq]firmware:redfish\[dq]\f[R] wicked interface configuration
requested during e.g.\ \f[CR]wicked ifup all\f[R] run.
.RE
.SS Utility actions
.TP
\f[CR]show\-config\f[R]
Decodes the SMBIOS structures with the Network Host Interface reference
and \[lq]Redfish over IP\[rq] protocol settings and shows the
\[lq]firmware:redfish\[rq] wicked interface configuration used by the
underlying extension.
.TP
\f[CR]list\-ifnames\f[R]
Decodes the SMBIOS structures and shows the referenced network host and
the vlan interface name \[en] if vlan is defined by the redfish
protocol.
.TP
\f[CR]hosts\-update\f[R]
Decodes the Redfish Service IP and Hostname from SMBIOS structure and
updates the redfish\-localhost entries in \f[CR]/etc/hosts\f[R].
.RS
.PP
Implements the \[lq]post\-up\[rq] action of the
`\f[CR]redfish\-update\f[R]' script hook used in the
\[lq]firmware:redfish\[rq] configuration executed at the end of an ifup
run.
.RE
.TP
\f[CR]hosts\-remove\f[R]
Removes the redfish\-localhost entries from \f[CR]/etc/hosts\f[R].
.RS
.PP
Implements the \[lq]pre\-down\[rq] action of the
`\f[CR]redfish\-update\f[R]' script hook used in the
\[lq]firmware:redfish\[rq] configuration executed in ifdown run.
.RE
.SH EXAMPLE
An Redfish Network Host Interface SMBIOS settings using DHCPv4 by
dmidecode:
.IP
.EX
# dmidecode \-t 42
Management Controller Host Interface
    Host Interface Type: Network
    Device Type: USB
        idVendor: 0x03f0
        idProduct: 0x2927
        Protocol ID: 04 (Redfish over IP)
            Service UUID: 8388efa4\-6501\-53a1\-a1da\-b6ee02cebbdf
            Host IP Assignment Type: DHCP
            Host IP Address Format: IPv4
            Redfish Service IP Discovery Type: DHCP
            Redfish Service IP Address Format: IPv4
            Redfish Service Hostname: virt152\-sp
.EE
.PP
The network interface name (as identified in the
`\f[CR]hwinfo \-\-netcard\f[R]') output is:
.IP
.EX
# ip link show dev usb0
11: usb0: <BROADCAST,MULTICAST> mtu 1500 qdisc pfifo_fast state DOWN mode DEFAULT group default qlen 1000
    link/ether 3a:d8:86:7c:01:64 brd ff:ff:ff:ff:ff:ff
.EE
.PP
The network interface name(s) can be identified/resolved by wicked:
.IP
.EX
# wicked redfish list\-ifnames
usb0
.EE
.PP
The Redfish Network Host Interface SMBIOS settings decoded by wicked to
an interface config:
.IP
.EX
# wicked redfish show\-config
<interface origin=\[dq]firmware:redfish\[dq]>
  <name>usb0</name>
  <scripts>
    <post\-up>
      <script>wicked:redfish\-update</script>
    </post\-up>
    <pre\-down>
      <script>wicked:redfish\-update</script>
    </pre\-down>
  </scripts>
  <ipv4>
    <enabled>true</enabled>
  </ipv4>
  <ipv4:dhcp>
    <enabled>true</enabled>
    <update/>
  </ipv4:dhcp>
</interface>
.EE
.PP
Once the Redfish Network Host Interface setup with wicked has been
enabled with:
.IP
.EX
# wicked redfish enable
.EE
.PP
The `\f[CR]wicked show\-config\f[R]' command contains the (same as
above) wicked configuration for the \f[CR]usb0\f[R] interface and
commands setting up interfaces are considering it:
.IP
.EX
# wicked ifreload all
usb0            device\-ready
usb0            up
# wicked ifstatus usb0
usb0            up
      link:     #11, state up, mtu 1500
      type:     ethernet, hwaddr 3a:d8:86:7c:01:64
      config:   firmware:redfish
      leases:   ipv4 dhcp granted
      addr:     ipv4 16.1.15.2/30 [dhcp]
# grep redfish\-localhost /etc/hosts
16.1.15.1   redfish\-localhost virt152\-sp
.EE
.PP
After disabling of the Redfish Network Host Interface setup with wicked,
the `\f[CR]wicked show\-config\f[R]' command stops to show the interface
configuration and the commands to setup interfaces will (shut it down if
still active and) stop to consider it in interface setup:
.IP
.EX
# wicked redfish disable
# wicked ifreload all
usb0            device\-ready
# grep redfish\-localhost /etc/hosts
# wicked ifstatus usb0
usb0            device\-unconfigured
      link:     #11, state down, mtu 1500
      type:     ethernet, hwaddr 3a:d8:86:7c:01:64
# ip link show dev usb0
11: usb0: <BROADCAST,MULTICAST> mtu 1500 qdisc pfifo_fast state DOWN mode DEFAULT group default qlen 1000
    link/ether 3a:d8:86:7c:01:64 brd ff:ff:ff:ff:ff:ff
# wicked ifreload all
wicked: ifreload: no configuration changes to reload
.EE
.SH NOTES
The implementation is based on the following specifications:
.IP \[bu] 2
DMTF DSP0134, System Management BIOS Reference Specification (SMBIOS),
Version 3.5.0
.RS 2
.IP \[bu] 2
https://www.dmtf.org/standards/smbios, https://www.dmtf.org/dsp/DSP0134
.RE
.IP \[bu] 2
DMTF DSP0270, Redfish Host Interface Specification, Version 1.3.0
.RS 2
.IP \[bu] 2
https://www.dmtf.org/standards/redfish, https://www.dmtf.org/dsp/DSP0270
.RE
.PP
and covers decoding of the (raw) SMBIOS Type 42 structures from sysfs
files (\f[CR]/sys/firmware/dmi/tables/smbios_entry_point\f[R] and
\f[CR]DMI\f[R]) with:
.IP \[bu] 2
Network Host Interface (40h) Device Description Data for:
.RS 2
.IP \[bu] 2
USB Network Interface
.IP \[bu] 2
PCI/PCIe Network Interface
.IP \[bu] 2
USB Network Interface v2
.RE
.IP \[bu] 2
Multiple Redfish over IP Protocol records with
.RS 2
.IP \[bu] 2
Static, DHCP, AutoConfigure Assignment/Discovery Types for IPv4 and IPv6
.RE
.IP \[bu] 2
Merge of multiple SMBIOS structures for the same device
.PP
Not yet implemented are:
.IP \[bu] 2
\[lq]Preferred IP\[rq] Address in AutoConfigure
.IP \[bu] 2
PCI/PCIe Network Interface v2
.IP \[bu] 2
Credential Bootstrapping
.SH COPYRIGHT
Copyright (C) 2022 SUSE LLC
.SH BUGS
Please report bugs as described at <@PACKAGE_BUGREPORT@>
.SH SEE ALSO
\f[B]\f[CB]wicked\f[B]\f[R](8), \f[B]\f[CB]wicked\-config\f[B]\f[R](5)
.SH AUTHORS
Marius Tomaschewski.
